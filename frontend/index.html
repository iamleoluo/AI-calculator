<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Calculator V2 - Fourier Series</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 10px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .hint {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .computing-section {
            display: none;
        }

        .progress-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #e0e0e0;
        }

        .progress-step.active {
            border-left-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .progress-step.complete {
            border-left-color: #28a745;
        }

        .step-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .derivation-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .derivation-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            line-height: 1.8;
            font-size: 16px;
        }

        .derivation-content h2 {
            color: #667eea;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .derivation-content h2:first-child {
            margin-top: 0;
        }

        .derivation-content code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        .derivation-streaming-indicator {
            display: inline-block;
            width: 8px;
            height: 16px;
            background: #667eea;
            animation: blink 1s infinite;
            margin-left: 4px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .results {
            display: none;
        }

        .result-section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .result-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .verification-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .verification-pass {
            background: #d4edda;
            color: #155724;
        }

        .verification-warning {
            background: #fff3cd;
            color: #856404;
        }

        .verification-fail {
            background: #f8d7da;
            color: #721c24;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #dc3545;
        }

        .info-message {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #17a2b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§® AI Calculator <span class="badge">V2</span></h1>
        <p class="subtitle">é€æ˜åŒ–çš„ AI æ•¸å­¸æ¨ç† - å‚…ç«‹è‘‰ç´šæ•¸è¨ˆç®—ï¼ˆæµå¼è¼¸å‡ºç‰ˆï¼‰</p>

        <div class="input-section">
            <h2 style="margin-bottom: 20px; color: #333;">è¼¸å…¥å‡½æ•¸</h2>

            <div class="form-group">
                <label for="functionExpr">å‡½æ•¸è¡¨é”å¼ (Python èªæ³•)</label>
                <input type="text" id="functionExpr" value="np.sin(t)" placeholder="ä¾‹å¦‚: np.sin(t), np.cos(2*t), t**2">
                <div class="hint">ä½¿ç”¨ np.sin, np.cos, np.exp ç­‰ NumPy å‡½æ•¸ã€‚è®Šæ•¸å¿…é ˆæ˜¯ tã€‚</div>
            </div>

            <div class="form-group">
                <label for="period">é€±æœŸ (T)</label>
                <input type="number" id="period" value="6.283185" step="0.000001" placeholder="ä¾‹å¦‚: 6.283185 (2Ï€)">
                <div class="hint">å‡½æ•¸çš„é€±æœŸï¼Œä¾‹å¦‚ sin(t) çš„é€±æœŸæ˜¯ 2Ï€ â‰ˆ 6.283185</div>
            </div>

            <div class="form-group">
                <label for="nTerms">é …æ•¸ (n)</label>
                <input type="number" id="nTerms" value="3" min="1" max="20" placeholder="1-20">
                <div class="hint">è¨ˆç®—å‚…ç«‹è‘‰ç´šæ•¸çš„é …æ•¸ (1-20)</div>
            </div>

            <button id="computeBtn" onclick="computeFourier()">é–‹å§‹è¨ˆç®—</button>
        </div>

        <!-- Computing Progress Section -->
        <div class="computing-section" id="computingSection">
            <div class="progress-container">
                <h2 style="margin-bottom: 20px; color: #333;">âš¡ è¨ˆç®—é€²åº¦</h2>
                <div id="progressSteps"></div>
            </div>

            <!-- Live Derivation Display -->
            <div class="derivation-section" id="derivationSection" style="display:none;">
                <h2 style="margin-bottom: 15px; color: #333;">ğŸ“– AI æ¨å°éç¨‹ï¼ˆå¯¦æ™‚ï¼‰</h2>
                <div class="derivation-content" id="derivationContent"></div>
            </div>
        </div>

        <!-- Final Results Section -->
        <div class="results" id="results">
            <div id="statusMessage"></div>

            <div class="result-section">
                <h2>ğŸ“Š é©—è­‰çµæœ</h2>
                <div id="verificationInfo"></div>
            </div>

            <div class="result-section">
                <h2>ğŸ“ˆ è¦–è¦ºåŒ–æ¯”è¼ƒ</h2>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>

            <div class="result-section">
                <h2>ğŸ“‰ é€é»èª¤å·®</h2>
                <div class="chart-container">
                    <canvas id="errorChart"></canvas>
                </div>
            </div>

            <div class="result-section">
                <h2>ğŸ¤” å®Œæ•´æ¨å°éç¨‹</h2>
                <div id="finalDerivation" class="derivation-content"></div>
            </div>
        </div>

        <div id="errorContainer"></div>
    </div>

    <script>
        // ==================== é…ç½®å€åŸŸ ====================
        // éƒ¨ç½²åˆ° Cloudflare æ™‚ï¼Œè«‹ä¿®æ”¹ BACKEND_URL
        const API_CONFIG = {
            // æœ¬åœ°é–‹ç™¼
            LOCAL: 'http://localhost:8000',
            // ç”Ÿç”¢ç’°å¢ƒ - è«‹åœ¨éƒ¨ç½²å‰ä¿®æ”¹ç‚ºä½ çš„å¾Œç«¯ URL
            // ä¾‹å¦‚ï¼š'https://your-app.railway.app' æˆ– 'https://your-backend.com'
            PRODUCTION: 'YOUR_BACKEND_URL_HERE',  // âš ï¸ éƒ¨ç½²æ™‚å¿…é ˆä¿®æ”¹é€™è£¡ï¼
        };

        // è‡ªå‹•æª¢æ¸¬ç’°å¢ƒ
        const isLocalhost = window.location.hostname === 'localhost' ||
                            window.location.hostname === '127.0.0.1' ||
                            window.location.hostname === '';

        const BACKEND_URL = isLocalhost ? API_CONFIG.LOCAL : API_CONFIG.PRODUCTION;

        // é¡¯ç¤ºç•¶å‰é…ç½®ï¼ˆæ–¹ä¾¿é™¤éŒ¯ï¼‰
        console.log('ğŸ”§ API Configuration:', {
            hostname: window.location.hostname,
            isLocalhost: isLocalhost,
            backendURL: BACKEND_URL
        });

        // æª¢æŸ¥ç”Ÿç”¢ç’°å¢ƒæ˜¯å¦é…ç½®äº†å¾Œç«¯ URL
        if (!isLocalhost && BACKEND_URL === 'YOUR_BACKEND_URL_HERE') {
            console.error('âš ï¸ è­¦å‘Šï¼šå°šæœªé…ç½®ç”Ÿç”¢ç’°å¢ƒçš„å¾Œç«¯ URLï¼');
            alert('éŒ¯èª¤ï¼šå°šæœªé…ç½®å¾Œç«¯ API åœ°å€ã€‚\n\nè«‹ä¿®æ”¹ index_v2.html ä¸­çš„ API_CONFIG.PRODUCTION');
        }
        // ==================== é…ç½®å€åŸŸçµæŸ ====================

        let comparisonChart = null;
        let errorChart = null;
        let eventSource = null;
        let sessionData = {
            derivation: '',
            verification: null,
            visualization: null,
            iterations: 0
        };

        // Progress steps configuration
        const PROGRESS_STEPS = {
            session_created: { icon: 'ğŸ¯', text: 'Session å·²å»ºç«‹' },
            derivation_chunk: { icon: 'ğŸ“', text: 'AI æ­£åœ¨æ¨å°...' },
            derivation_complete: { icon: 'âœ…', text: 'æ¨å°å®Œæˆ' },
            code_generated: { icon: 'ğŸ’»', text: 'ä»£ç¢¼ç”Ÿæˆå®Œæˆ' },
            verification_result: { icon: 'ğŸ”', text: 'é©—è­‰ä¸­...' },
            error_analysis: { icon: 'ğŸ§ ', text: 'AI éŒ¯èª¤åˆ†æ' },
            success: { icon: 'ğŸ‰', text: 'è¨ˆç®—æˆåŠŸï¼' },
            success_with_warning: { icon: 'âš ï¸', text: 'å®Œæˆï¼ˆæœ‰è­¦å‘Šï¼‰' },
            failed: { icon: 'âŒ', text: 'è¨ˆç®—å¤±æ•—' }
        };

        function updateProgressStep(type, message) {
            const config = PROGRESS_STEPS[type];
            if (!config) return;

            const container = document.getElementById('progressSteps');
            const stepId = `step-${type}`;  // Fixed ID without timestamp

            // Check if step already exists
            let stepElement = document.getElementById(stepId);

            if (stepElement) {
                // Update existing step
                const contentDiv = stepElement.querySelector('div:last-child');
                if (contentDiv) {
                    contentDiv.innerHTML = `
                        <strong>${config.text}</strong>
                        ${message ? `<div style="color: #666; font-size: 0.9em; margin-top: 4px;">${message}</div>` : ''}
                    `;
                }
            } else {
                // Create new step
                // Mark previous steps as complete
                document.querySelectorAll('.progress-step.active').forEach(el => {
                    el.classList.remove('active');
                    el.classList.add('complete');
                });

                const stepHtml = `
                    <div class="progress-step active" id="${stepId}">
                        <div class="step-icon">${config.icon}</div>
                        <div>
                            <strong>${config.text}</strong>
                            ${message ? `<div style="color: #666; font-size: 0.9em; margin-top: 4px;">${message}</div>` : ''}
                        </div>
                    </div>
                `;

                container.innerHTML += stepHtml;
            }

            // Scroll to bottom
            container.scrollTop = container.scrollHeight;
        }

        function appendDerivationChunk(chunk) {
            const derivationSection = document.getElementById('derivationSection');
            const derivationContent = document.getElementById('derivationContent');

            derivationSection.style.display = 'block';

            // Append chunk
            sessionData.derivation += chunk;

            // Parse Markdown and render
            const html = marked.parse(sessionData.derivation);
            derivationContent.innerHTML = html + '<span class="derivation-streaming-indicator"></span>';

            // Trigger MathJax to re-render math
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([derivationContent]).catch((err) => console.log('MathJax error:', err));
            }

            // Auto-scroll
            derivationContent.scrollTop = derivationContent.scrollHeight;
        }

        function completeDerivation() {
            const derivationContent = document.getElementById('derivationContent');

            // Remove streaming indicator
            const html = marked.parse(sessionData.derivation);
            derivationContent.innerHTML = html;

            // Final MathJax render
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([derivationContent]).catch((err) => console.log('MathJax error:', err));
            }
        }

        async function computeFourier() {
            const functionExpr = document.getElementById('functionExpr').value;
            const period = parseFloat(document.getElementById('period').value);
            const nTerms = parseInt(document.getElementById('nTerms').value);

            // Validation
            if (!functionExpr || !period || !nTerms) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }

            // Reset
            document.getElementById('computeBtn').disabled = true;
            document.getElementById('computingSection').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.getElementById('errorContainer').innerHTML = '';
            document.getElementById('progressSteps').innerHTML = '';
            document.getElementById('derivationSection').style.display = 'none';
            sessionData = { derivation: '', verification: null, visualization: null, iterations: 0 };

            // Close existing EventSource
            if (eventSource) {
                eventSource.close();
            }

            try {
                // Use EventSource for SSE
                const url = new URL(`${BACKEND_URL}/api/v2/fourier-series/stream`);

                // Create EventSource with POST data (workaround: use sync endpoint for now)
                // EventSource doesn't support POST, so we'll use fetch with stream
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        function_expr: functionExpr,
                        period: period,
                        n_terms: nTerms
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();

                while (true) {
                    const { value, done } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const data = line.substring(6);
                            try {
                                const event = JSON.parse(data);
                                handleEvent(event);
                            } catch (e) {
                                console.error('JSON parse error:', e, data);
                            }
                        }
                    }
                }

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorContainer').innerHTML = `
                    <div class="error-message">
                        <strong>éŒ¯èª¤ï¼š</strong> ${error.message}
                    </div>
                `;
            } finally {
                document.getElementById('computeBtn').disabled = false;
            }
        }

        function handleEvent(event) {
            console.log('Event:', event);

            switch (event.type) {
                case 'session_created':
                    updateProgressStep('session_created', `Session ID: ${event.session_id}`);
                    break;

                case 'iteration_start':
                    sessionData.iterations = event.iteration;
                    updateProgressStep('iteration_start', `è¿­ä»£ ${event.iteration}`);
                    // Reset derivation for new iteration
                    if (event.iteration > 1) {
                        sessionData.derivation = '';
                        document.getElementById('derivationContent').innerHTML = '';
                    }
                    break;

                case 'derivation_chunk':
                    appendDerivationChunk(event.content);
                    updateProgressStep('derivation_chunk');
                    break;

                case 'derivation_complete':
                    completeDerivation();
                    updateProgressStep('derivation_complete', `${sessionData.derivation.length} å­—å…ƒ`);
                    break;

                case 'code_generated':
                    updateProgressStep('code_generated');
                    console.log('Generated code:', event.code);
                    break;

                case 'verification_result':
                    sessionData.verification = event.result;
                    const verified = event.result.is_verified;
                    const maxError = event.result.error_metrics?.max_relative_error || 0;
                    updateProgressStep('verification_result',
                        verified ? `âœ“ é€šé (èª¤å·®: ${(maxError * 100).toFixed(4)}%)` : 'âœ— æœªé€šé');
                    break;

                case 'error_analysis':
                    const analysis = event.analysis;
                    updateProgressStep('error_analysis',
                        `${analysis.error_category} (${analysis.severity})`);
                    break;

                case 'success':
                case 'success_with_warning':
                    updateProgressStep(event.type);
                    displayFinalResults(event.result);
                    break;

                case 'failed':
                case 'max_iterations_reached':
                    updateProgressStep(event.type, event.reason || event.message);
                    showError(event.reason || 'é”åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•¸');
                    break;

                default:
                    console.log('Unknown event type:', event.type);
            }
        }

        function displayFinalResults(result) {
            // Show results section
            document.getElementById('results').style.display = 'block';

            // Status message
            let statusHtml = '';
            if (result.success === false && result.status === 'acceptable_error') {
                statusHtml = `
                    <div class="info-message">
                        â„¹ï¸ ${result.error_analysis?.explanation || 'è¨ˆç®—å®Œæˆï¼Œå­˜åœ¨å¯æ¥å—çš„èª¤å·®'}
                        <br><small>${result.error_analysis?.suggestion_to_user || ''}</small>
                    </div>
                `;
            } else if (sessionData.iterations > 1) {
                statusHtml = `
                    <div class="info-message">
                        âœ“ AI ç¶“é ${sessionData.iterations} æ¬¡è¿­ä»£å¾ŒæˆåŠŸè¨ˆç®—
                    </div>
                `;
            }
            document.getElementById('statusMessage').innerHTML = statusHtml;

            // Verification info
            if (result.verification || sessionData.verification) {
                const verification = result.verification || sessionData.verification;
                const maxError = verification.error_metrics?.max_relative_error || verification.max_relative_error || 0;
                const meanError = verification.error_metrics?.mean_relative_error || verification.mean_relative_error || 0;

                let badgeClass = 'verification-pass';
                let badgeText = 'âœ“ é©—è­‰é€šé';

                if (!verification.is_verified) {
                    if (result.status === 'acceptable_error') {
                        badgeClass = 'verification-warning';
                        badgeText = 'âš ï¸ å¯æ¥å—çš„èª¤å·®';
                    } else {
                        badgeClass = 'verification-fail';
                        badgeText = 'âœ— é©—è­‰å¤±æ•—';
                    }
                }

                document.getElementById('verificationInfo').innerHTML = `
                    <div class="verification-badge ${badgeClass}">${badgeText}</div>
                    <p><strong>æœ€å¤§ç›¸å°èª¤å·®:</strong> ${(maxError * 100).toFixed(6)}%</p>
                    <p><strong>å¹³å‡ç›¸å°èª¤å·®:</strong> ${(meanError * 100).toFixed(6)}%</p>
                `;
            }

            // Visualization
            if (result.visualization) {
                displayCharts(result.visualization);
            }

            // Final derivation
            if (result.derivation || sessionData.derivation) {
                const derivation = result.derivation || sessionData.derivation;
                const html = marked.parse(derivation);
                document.getElementById('finalDerivation').innerHTML = html;

                if (typeof MathJax !== 'undefined') {
                    MathJax.typesetPromise([document.getElementById('finalDerivation')])
                        .catch((err) => console.log('MathJax error:', err));
                }
            }
        }

        function displayCharts(vizData) {
            if (!vizData || !vizData.t_points) return;

            // Comparison chart
            const comparisonCtx = document.getElementById('comparisonChart');
            if (comparisonChart) {
                comparisonChart.destroy();
            }

            comparisonChart = new Chart(comparisonCtx, {
                type: 'line',
                data: {
                    labels: vizData.t_points,
                    datasets: [
                        {
                            label: 'åŸå§‹å‡½æ•¸',
                            data: vizData.original_values,
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            borderWidth: 2,
                            pointRadius: 0
                        },
                        {
                            label: 'å‚…ç«‹è‘‰é‡å»º',
                            data: vizData.reconstructed_values,
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'åŸå§‹å‡½æ•¸ vs å‚…ç«‹è‘‰ç´šæ•¸é‡å»º'
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 't' },
                            ticks: { maxTicksLimit: 10 }
                        },
                        y: {
                            title: { display: true, text: 'f(t)' }
                        }
                    }
                }
            });

            // Error chart
            const errorCtx = document.getElementById('errorChart');
            if (errorChart) {
                errorChart.destroy();
            }

            errorChart = new Chart(errorCtx, {
                type: 'line',
                data: {
                    labels: vizData.t_points,
                    datasets: [{
                        label: 'é€é»èª¤å·®',
                        data: vizData.pointwise_error || vizData.pointwise_errors,
                        borderColor: 'rgb(255, 159, 64)',
                        backgroundColor: 'rgba(255, 159, 64, 0.2)',
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `é€é»èª¤å·® (æœ€å¤§: ${(vizData.max_pointwise_error || 0).toFixed(6)})`
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 't' },
                            ticks: { maxTicksLimit: 10 }
                        },
                        y: {
                            title: { display: true, text: '|èª¤å·®|' }
                        }
                    }
                }
            });
        }

        function showError(message) {
            document.getElementById('errorContainer').innerHTML = `
                <div class="error-message">
                    <strong>éŒ¯èª¤ï¼š</strong> ${message}
                </div>
            `;
        }
    </script>
</body>
</html>
